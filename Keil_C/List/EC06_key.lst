C51 COMPILER V9.56.0.0   EC06_KEY                                                          09/07/2020 22:21:34 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE EC06_KEY
OBJECT MODULE PLACED IN ..\Output\EC06_key.obj
COMPILER INVOKED BY: E:\keil5\C51\BIN\C51.EXE ..\User\EC06_key.c OMF2 OPTIMIZE(8,SPEED) BROWSE INCDIR(..\FWLib\SC95F8x1x
                    -_Lib\inc;..\User) DEBUG PRINT(..\List\EC06_key.lst) OBJECT(..\Output\EC06_key.obj)

line level    source

   1          //************************************************************
   2          //  Copyright (c) ÉîÛÚÊÐÈüÔªÎ¢µç×ÓÓÐÏÞ¹«Ë¾
   3          //      ÎÄ¼þÃû³Æ        : EC06_key.c
   4          //      ×÷Õß            : 
   5          //      Ä£¿é¹¦ÄÜ        : Ðý×ª±àÂëÆ÷
   6          //      ¾Ö²¿º¯ÊýÁÐ±í:
   7          //  ×îºó¸üÕýÈÕÆÚ: 2019/7/10
   8          //      °æ±¾            : V1.0 
   9          //  ËµÃ÷        £º  
  10          //*************************************************************
  11          #include "EC06_key.h"
  12          //#include "interface.h"
  13          //#include "SC_it.h"
  14          
  15          bit spin_int1_flag = 0;
  16          
  17          bit Key_left_short;
  18          bit Key_right_short;
  19          
  20          bit Key_left_long;
  21          bit Key_right_long;
  22          
  23          bit spin_left           = 0,
  24                  spin_right              = 0,
  25                  
  26                  spin_short              = 0,
  27                  spin_long               = 0,
  28          
  29                  spin_long_left  = 0,
  30                  spin_long_right = 0;
  31          
  32          
  33          uint32_t Temper; 
  34          
  35          
  36          //×¢ÒâÊÂÏî£ºEC11Ðý×ª±àÂëÆ÷µÄÉ¨ÃèÊ±¼ä¼ä¸ô¿ØÖÆÔÚ1~4msÖ®¼ä
  37          //·ñÔò5ms¼°ÒÔÉÏµÄÉ¨ÃèÊ±¼äÔÚ¿ìËÙÐý×ªÊ±¿ÉÄÜ»áÎóÅÐÐý×ª·½Ïò
  38          
  39          
  40          
  41          
  42          //*******************************************************************/
  43          //¹¦ÄÜ£º³õÊ¼»¯EC11Ðý×ª±àÂëÆ÷Ïà¹Ø²ÎÊý
  44          //ÐÎ²Î£ºEC11Ðý×ª±àÂëÆ÷µÄÀàÐÍ-->>  unsigned char Set_EC11_TYPE  <<--  £º0----Ò»¶¨Î»¶ÔÓ¦Ò»Âö³å£»1£¨»ò·Ç0£©--
             ---Á½¶¨Î»¶ÔÓ¦Ò»Âö³å¡£
  45          //·µ»Ø£ºÎÞ
  46          //Ïê½â£º¶ÔEC11Ðý×ª±àÂëÆ÷µÄÁ¬½ÓIO¿Ú×öIO¿ÚÄ£Ê½ÉèÖÃ¡£ÒÔ¼°½«Ïà¹ØµÄ±äÁ¿½øÐÐ³õÊ¼»¯
  47          //*******************************************************************/
  48          //void Encoder_EC11_Init(unsigned char Set_EC11_TYPE)
  49          //{
  50          //    //IO¿ÚÄ£Ê½³õÊ¼»¯¡£³õÊ¼»¯EC11µÄIO¿ÚÎª×¼Ë«ÏòÄ£Ê½
  51          ////    P35_QB();
  52          ////    P36_QB();
  53          ////    P37_QB();
C51 COMPILER V9.56.0.0   EC06_KEY                                                          09/07/2020 22:21:34 PAGE 2   

  54          //    
  55          //    EC11_A_Now = 0;
  56          //    EC11_B_Now = 0;
  57          ////    EC11_Key = 0;
  58          
  59          ////    //EC11ÀàÐÍÑ¡Ôñ£º0-Ò»¶¨Î»Ò»Âö³å£»1-Á½¶¨Î»Ò»Âö³å
  60          ////    if(Set_EC11_TYPE == 0)
  61          ////    {
  62          ////        EC11_Type = 0;
  63          ////    }
  64          ////    else
  65          ////    {
  66          ////        EC11_Type = 1;
  67          ////    }
  68          
  69          ////    //±ÜÃâÉÏµçÊ±EC11ÐýÅ¥Î»ÖÃ²»È·¶¨µ¼ÖÂÒ»´Î¶¯×÷ÎóÅÐ
  70          ////    EC11_A_Last = EC11_A_Now;   
  71          ////    EC11_B_Last = EC11_B_Now;
  72          
  73          ////    //--------Çå³ý°´¼ü¼ÆÊýÆ÷ºÍ±êÖ¾Î»--------//
  74          ////    EC11_KEY_COUNT = 0;                     //EC11°´¼ü¶¯×÷¼ÆÊýÆ÷
  75          ////    EC11_KEY_DoubleClick_Count = 0;         //EC11°´¼üË«»÷¶¯×÷¼ÆÊýÆ÷
  76          ////    FLAG_EC11_KEY_ShotClick = 0;            //EC11°´¼ü¶Ì°´¶¯×÷±êÖ¾
  77          ////    FLAG_EC11_KEY_LongClick = 0;            //EC11°´¼ü³¤°´¶¯×÷±êÖ¾
  78          ////    FLAG_EC11_KEY_DoubleClick = 0;          //EC11°´¼üË«»÷¶¯×÷±êÖ¾
  79          //      
  80          //}
  81          
  82          /**************************************************
  83          *º¯ÊýÃû³Æ£ºvoid key_scan(void)
  84          *º¯Êý¹¦ÄÜ£º×óÓÒ°´¼üÉ¨Ãè
  85          *Èë¿Ú²ÎÊý£º
  86          *³ö¿Ú²ÎÊý£ºvoid
  87          **************************************************/
  88          void key_scan(void)     
  89          {       
  90   1              static unsigned char Key_left_count;
  91   1              static unsigned char Key_right_count;
  92   1              static unsigned char EC11_Key_count;
  93   1              
  94   1               /*left¼üÉ¨Ãè*/
  95   1              if(keyleft == 0)                                                                //left¼ü°´ÏÂÖÃÁã
  96   1            {
  97   2                        if(Key_left_count<250)                                        //left¼ü°´ÏÂ¼ÆÊý
  98   2                                      Key_left_count++;                               
  99   2                        if(Key_left_count>=200)                                       //ÅÐ¶Ï³¤°´
 100   2                              {               
 101   3                                      Key_left_long=1;   //bit                        //³¤°´±êÖ¾Î»ÖÃÒ»
 102   3                              }
 103   2                }
 104   1              if(keyleft == 1)                                                                //left¼üËÉ¿ªÅÐ¶Ï
 105   1               {
 106   2                        if(Key_left_count<50&&Key_left_count>0)       //ÅÐ¶Ï¶Ì°´              
 107   2                              {               
 108   3                                      Key_left_short=1;  //bit                        //¶Ì°´ÖÃÒ»
 109   3                              }
 110   2                              Key_left_count = 0;                                             //left¼ü¼ÆÊýÇåÁã
 111   2                              Key_left_long = 0;      
 112   2               }
 113   1               
 114   1                /*right¼üÉ¨Ãè*/
 115   1           if(keyright == 0)                                                  //right¼ü°´ÏÂÖÃÁã
C51 COMPILER V9.56.0.0   EC06_KEY                                                          09/07/2020 22:21:34 PAGE 3   

 116   1            {
 117   2                        if(Key_right_count<250)                           //right¼ü°´ÏÂ¼ÆÊý
 118   2                                      Key_right_count++; 
 119   2                        if(Key_right_count>=200)                              //ÅÐ¶Ï³¤°´
 120   2                              {               
 121   3                                      Key_right_long=1;                               //³¤°´±êÖ¾Î»ÖÃÒ»                        
 122   3                              }
 123   2                }
 124   1              if(keyright == 1)                                                                       //right¼üËÉ¿ªÅÐ¶Ï
 125   1               {
 126   2                        if(Key_right_count<50&&Key_right_count>0)             //ÅÐ¶Ï¶Ì°´
 127   2                              {                       
 128   3                                      Key_right_short=1;  //bit                               //¶Ì°´ÖÃÒ»      
 129   3                              }
 130   2                              Key_right_count = 0;                                                    //right¼ü¼ÆÊýÇåÁã       
 131   2                              Key_right_long = 0;
 132   2            }
 133   1               
 134   1                /*middle¼üÉ¨Ãè*/
 135   1               if(EC11_Key == 0)                                                      //middle¼ü°´ÏÂÖÃÁã
 136   1            {
 137   2                        if(EC11_Key_count<250)                            //middle¼ü°´ÏÂ¼ÆÊý
 138   2                                      EC11_Key_count++; 
 139   2                        if(EC11_Key_count>=200)                               //ÅÐ¶Ï³¤°´
 140   2                              {               
 141   3                                      spin_long=1;                            //³¤°´±êÖ¾Î»ÖÃÒ»                        
 142   3                              }
 143   2                }
 144   1              if(EC11_Key == 1)                                                                       //middle¼üËÉ¿ªÅÐ¶Ï
 145   1               {
 146   2                        if(EC11_Key_count<50&&EC11_Key_count>0)               //ÅÐ¶Ï¶Ì°´
 147   2                              {                       
 148   3                                      spin_short=1;  //bit                            //¶Ì°´ÖÃÒ»      
 149   3                              }
 150   2                              EC11_Key_count = 0;                                                     //middle¼ü¼ÆÊýÇåÁã      
 151   2                              spin_long = 0;
 152   2            }
 153   1               
 154   1      }
 155          
 156          /**************************************************
 157          *º¯ÊýÃû³Æ£ºvoid spin_scan(void)
 158          *º¯Êý¹¦ÄÜ£ºÐý×ª±àÂëÆ÷É¨Ãè
 159          *Èë¿Ú²ÎÊý£ºÐý×ª±êÖ¾ÔÚINT2ÖÐ¶Ï²É¼¯¶¯×÷£¬É¨ÃèÔÚTIME2Àï·ÖÎö£¬²¢ÇÒÃ»²É¼¯Ò»´Î¶¯×÷£¬TIME2ÖØ×°Ò»´Î
 160                            ÎªÁËÃ¿²É¼¯Ò»´Î¶¯×÷£¬1msºó½øÈë¶¨Ê±Æ÷           
 161          *³ö¿Ú²ÎÊý£ºvoid
 162          **************************************************/
 163          void spin_scan(void)    
 164          {       
 165   1              if(spin_int1_flag == 1)        //µ±A·¢ÉúÌø±äÊ±²É¼¯Bµ±Ç°µÄ×´Ì¬£¬²¢½«BÓëÉÏÒ»´ÎµÄ×´Ì¬½øÐÐ¶Ô±È¡£
 166   1              {                                   //ÈôA 0->1 Ê±£¬B 1->0 Õý×ª£»ÈôA 1->0 Ê±£¬B 0->1 Õý×ª£»
 167   2                                                                                //ÈôA 0->1 Ê±£¬B 0->1 ·´×ª£»ÈôA 1->0 Ê±£¬B 1->0 ·´×ª
 168   2                      if(EC11_A_Now == 1)     //EC11_AºÍÉÏÒ»´Î×´Ì¬Ïà±È£¬ÎªÉÏÉýÑØ
 169   2                      {
 170   3                        
 171   3                              if(EC11_B_Now == 0)   //EC11_BºÍÉÏÒ»´Î×´Ì¬Ïà±È£¬ÎªÏÂ½µÑØ
 172   3                                      spin_right = 1;                         //Õý×ª
 173   3      
 174   3                              if(EC11_B_Now == 1)   //EC11_BºÍÉÏÒ»´Î×´Ì¬Ïà±È£¬ÎªÉÏÉýÑØ               
 175   3                                      spin_left = 1;                        //·´×ª
 176   3                      }
 177   2                      else                                     //EC11_AºÍÉÏÒ»´Î×´Ì¬Ïà±È£¬ÎªÏÂ½µÑØ
C51 COMPILER V9.56.0.0   EC06_KEY                                                          09/07/2020 22:21:34 PAGE 4   

 178   2                      {  
 179   3                              
 180   3                              if(EC11_B_Now == 1)  //AÉÏÉýÑØÊ±£¬²É¼¯µÄB²»±äÇÒÎª0
 181   3                                      spin_right = 1;                                 //Õý×ª
 182   3      
 183   3                              if(EC11_B_Now == 0)  //AÉÏÉýÑØÊ±£¬²É¼¯µÄB²»±äÇÒÎª1
 184   3                                      spin_left = 1;                                //·´×ª
 185   3                      }
 186   2         
 187   2                      spin_int1_flag = 0;
 188   2              }
 189   1      }
 190          
 191          //*******************************************************************/
 192          //¹¦ÄÜ£ºÉ¨ÃèEC11Ðý×ª±àÂëÆ÷µÄ¶¯×÷²¢½«²ÎÊý·µ»Ø¸ø¶¯×÷·ÖÎöº¯ÊýÊ¹ÓÃ
 193          //ÐÎ²Î£ºEC11Ðý×ª±àÂëÆ÷µÄÀàÐÍ-->>  unsigned char Set_EC11_TYPE  <<--  £º0----Ò»¶¨Î»¶ÔÓ¦Ò»Âö³å£»1£¨»ò·Ç0£©--
             ---Á½¶¨Î»¶ÔÓ¦Ò»Âö³å
 194          //·µ»Ø£ºEC11Ðý×ª±àÂëÆ÷µÄÉ¨Ãè½á¹û-->>  char ScanResult  -->>  0£ºÎÞ¶¯×÷£»1£ºÕý×ª£» -1£º·´×ª£»2£ºÖ»°´ÏÂ°´¼ü£
             -»3£º°´×Å°´¼üÕý×ª£»-3£º°´×Å°´¼ü·´×ª
 195          //Ïê½â£ºÖ»É¨ÃèEC11Ðý×ª±àÂëÆ÷ÓÐÃ»ÓÐ¶¯×÷£¬²»¹ØÐÄÊÇµÚ¼¸´Î°´ÏÂ°´¼ü»ò³¤°´»òË«»÷¡£·µ»ØÖµÖ±½Ó×÷ÎªÐÎ²Î´«¸ø [ void 
             -Encoder_EC11_Analyze(char EC11_Value); ] º¯ÊýÊ¹ÓÃ
 196          //*******************************************************************/
 197          char Encoder_EC11_Scan()
 198          {
 199   1      //ÒÔÏÂ´¢´æA¡¢BÉÏÒ»´ÎÖµµÄ±äÁ¿ÉùÃ÷Îª¾²Ì¬È«¾Ö±äÁ¿£¬·½±ã¶ÔEC11¶ÔÓ¦µÄIO¿Ú×ö³õÊ¼»¯
 200   1      //  static char EC11_A_Last = 0;
 201   1      //  static char EC11_B_Last = 0;
 202   1          char ScanResult = 0;    //·µ»Ø±àÂëÆ÷É¨Ãè½á¹û£¬ÓÃÓÚ·ÖÎö±àÂëÆ÷µÄ¶¯×÷
 203   1                                  //·µ»ØÖµµÄÈ¡Öµ£º   0£ºÎÞ¶¯×÷£»      1£ºÕý×ª£»           -1£º·´×ª£»  
 204   1                                  //                2£ºÖ»°´ÏÂ°´¼ü£»    3£º°´×Å°´¼üÕý×ª£»   -3£º°´×Å°´¼ü·´×ª
 205   1                                  //======================================================//
 206   1      //    if(EC11_Type == 0)      //================Ò»¶¨Î»¶ÔÓ¦Ò»Âö³åµÄEC11================//
 207   1      //    {                       //======================================================//
 208   1      //        if(EC11_A_Now != EC11_A_Last)   //ÒÔAÎªÊ±ÖÓ£¬BÎªÊý¾Ý¡£Õý×ªÊ±AB·´Ïà£¬·´×ªÊ±ABÍ¬Ïà
 209   1      //        {
 210   1      //            if(EC11_A_Now == 0)
 211   1      //            {
 212   1      //                if(EC11_B_Now == 1)      //Ö»ÐèÒª²É¼¯AµÄÉÏÉýÑØ»òÏÂ½µÑØµÄÈÎÒâÒ»¸ö×´Ì¬£¬ÈôAÏÂ½µÑØÊ±BÎª1£¬Õ
             -ý×ª                    
 213   1      //                    ScanResult = 1;     //Õý×ª
 214   1      
 215   1      //                else                    //·´×ª
 216   1      //                    ScanResult = -1;
 217   1      //            }
 218   1      //            EC11_A_Last = EC11_A_Now;   //¸üÐÂ±àÂëÆ÷ÉÏÒ»¸ö×´Ì¬ÔÝ´æ±äÁ¿
 219   1      //            EC11_B_Last = EC11_B_Now;   //¸üÐÂ±àÂëÆ÷ÉÏÒ»¸ö×´Ì¬ÔÝ´æ±äÁ¿
 220   1      //        }
 221   1      //    }   
 222   1      //                            //======================================================//
 223   1      //    else                    //================Á½¶¨Î»¶ÔÓ¦Ò»Âö³åµÄEC11================//
 224   1      //    {                       //======================================================//
 225   1              if(spin_int1_flag == 1)        //µ±A·¢ÉúÌø±äÊ±²É¼¯Bµ±Ç°µÄ×´Ì¬£¬²¢½«BÓëÉÏÒ»´ÎµÄ×´Ì¬½øÐÐ¶Ô±È¡£
 226   1              {                                   //ÈôA 0->1 Ê±£¬B 1->0 Õý×ª£»ÈôA 1->0 Ê±£¬B 0->1 Õý×ª£»
 227   2                                                //ÈôA 0->1 Ê±£¬B 0->1 ·´×ª£»ÈôA 1->0 Ê±£¬B 1->0 ·´×ª
 228   2                  if(EC11_A_Now == 1)     //EC11_AºÍÉÏÒ»´Î×´Ì¬Ïà±È£¬ÎªÉÏÉýÑØ
 229   2                  {
 230   3                    
 231   3                                      if(EC11_B_Now == 0)   //EC11_BºÍÉÏÒ»´Î×´Ì¬Ïà±È£¬ÎªÏÂ½µÑØ
 232   3                          ScanResult = 1;                         //Õý×ª
 233   3      
 234   3                      if(EC11_B_Now == 1)   //EC11_BºÍÉÏÒ»´Î×´Ì¬Ïà±È£¬ÎªÉÏÉýÑØ               
 235   3                          ScanResult = -1;                        //·´×ª
C51 COMPILER V9.56.0.0   EC06_KEY                                                          09/07/2020 22:21:34 PAGE 5   

 236   3                              }
 237   2                              else                                     //EC11_AºÍÉÏÒ»´Î×´Ì¬Ïà±È£¬ÎªÏÂ½µÑØ
 238   2                              {  
 239   3                      if(EC11_B_Now == 1)  //AÉÏÉýÑØÊ±£¬²É¼¯µÄB²»±äÇÒÎª0
 240   3                          ScanResult = 1;                                 //Õý×ª
 241   3      
 242   3                      if(EC11_B_Now == 0)  //AÉÏÉýÑØÊ±£¬²É¼¯µÄB²»±äÇÒÎª1
 243   3                          ScanResult = -1;                                //·´×ª
 244   3                  }
 245   2             
 246   2      //            EC11_A_Last = EC11_A_Now;   //¸üÐÂ±àÂëÆ÷ÉÏÒ»¸ö×´Ì¬ÔÝ´æ±äÁ¿
 247   2      
 248   2              }
 249   1      //    }                                                                       
 250   1      
 251   1      //if(EC11_Key == 0)   //Èç¹ûEC11µÄ°´¼ü°´ÏÂ£¬²¢ÇÒÃ»ÓÐEC11Ã»ÓÐ×ª¶¯£¬
 252   1      //{
 253   1      //      if(ScanResult == 0)         //°´ÏÂ°´¼üÊ±Î´×ª¶¯
 254   1      //              ScanResult = 2;         //·µ»ØÖµÎª2
 255   1      //      else
 256   1      //      {
 257   1      //              if(ScanResult == 1)     //°´ÏÂ°´¼üÊ±ºòÕý×ª
 258   1      //                      ScanResult = 3;     //·µ»ØÖµÎª3
 259   1      //              if(ScanResult == -1)    //°´ÏÂ°´¼üÊ±ºò·´×ª
 260   1      //                      ScanResult = -3;    //·µ»ØÖµÎª-3
 261   1      //      }
 262   1      //}
 263   1      
 264   1       
 265   1              return ScanResult;      //·µ»ØÖµµÄÈ¡Öµ£º   0£ºÎÞ¶¯×÷£»      1£ºÕý×ª£»           -1£º·´×ª£»
 266   1              
 267   1      }                           //              2£ºÖ»°´ÏÂ°´¼ü£»    3£º°´×Å°´¼üÕý×ª£»   -3£º°´×Å°´¼ü·´×ª
 268          
 269          
 270          //*******************************************************************/
 271          //¹¦ÄÜ£º¶ÔEC11Ðý×ª±àÂëÆ÷µÄ¶¯×÷½øÐÐ·ÖÎö£¬²¢×÷³öÏàÓ¦µÄ¶¯×÷´¦Àí´úÂë
 272          //ÐÎ²Î£ºÎÞ
 273          //·µ»Ø£ºchar AnalyzeResult = 0;Ä¿Ç°ÎÞÓÃ¡£ÈôÔÚ¸Ãº¯ÊýÀï×öÁË¶¯×÷´¦Àí£¬Ôòº¯ÊýµÄ·µ»ØÖµÎÞÐèÀí»á
 274          //Ïê½â£º¶ÔEC11Ðý×ª±àÂëÆ÷µÄ¶¯×÷½øÐÐÄ£Ê½·ÖÎö£¬ÊÇµ¥»÷»¹ÊÇË«»÷»¹ÊÇ³¤°´ËÉÊÖ»¹ÊÇÒ»Ö±°´ÏÂ¡£ÐÎ²Î´Ó [ char Encoder_
             -EC11_Scan(unsigned char Set_EC11_TYPE) ] º¯Êý´«Èë¡£ÔÚ±¾º¯ÊýÄÚÐÞ¸ÄÐèÒªµÄ¶¯×÷´¦Àí´úÂë
 275          //*******************************************************************/
 276          char Encoder_EC11_Analyze(char EC11_Value)
 277          {
 278   1          char AnalyzeResult = 0;
 279   1          static unsigned int TMP_Value = 0;  //ÖÐ¼ä¼ÆÊýÖµ£¬ÓÃÓÚÁ¬Ðø³¤°´°´¼üµÄ¶¯×÷ÑÓÊ±¼ä¸ô
 280   1      
 281   1          //>>>>>>>>>>>>>>>>±àÂëÆ÷Õý×ª´¦Àí³ÌÐò<<<<<<<<<<<<<<<<//
 282   1              
 283   1      //              P51 = EC11_Value;
 284   1              
 285   1          if(EC11_Value == 1)     //Õý×ª
 286   1          {
 287   2                      spin_right = 1;
 288   2                       spin_int1_flag = 0; 
 289   2              //--------±àÂëÆ÷Õý×ª¶¯×÷´úÂë--------//
 290   2         
 291   2          }
 292   1      
 293   1          //>>>>>>>>>>>>>>>>±àÂëÆ÷·´×ª´¦Àí³ÌÐò<<<<<<<<<<<<<<<<//
 294   1          if(EC11_Value == -1)    //·´×ª
 295   1          {
 296   2                      spin_left = 1;
C51 COMPILER V9.56.0.0   EC06_KEY                                                          09/07/2020 22:21:34 PAGE 6   

 297   2                       spin_int1_flag = 0; 
 298   2              //--------±àÂëÆ÷·´×ª¶¯×÷´úÂë--------//
 299   2      
 300   2          }
 301   1      
 302   1              //>>>>>>>>>>>>>>>>±àÂëÆ÷°´¼ü°´ÏÂ´¦Àí³ÌÐò<<<<<<<<<<<<<<<<//
 303   1      //    if(EC11_Value == 2)               
 304   1      //    {
 305   1      //              //====¼ì²âµ½°´¼ü°´ÏÂ====//
 306   1      //              
 307   1      //              spin_short = 1;
 308   1      //              
 309   1      //        if(EC11_KEY_COUNT<10000)    //´ò¿ª°´¼ü°´ÏÂÊ±¼ä¶¨Ê±Æ÷
 310   1      //            EC11_KEY_COUNT++;
 311   1      //        if(EC11_KEY_COUNT == KEY_COUNT_DESHAKING)   //°´ÏÂ°´¼üÊ±¼äµ½´ïÏû¶¶Ê±¼äÊ±
 312   1      //        {                                           //ÖÃÎ»¶Ì°´°´¼ü±êÖ¾
 313   1      //            FLAG_EC11_KEY_ShotClick = 1;
 314   1      //        }
 315   1      
 316   1      //        if((EC11_KEY_DoubleClick_Count > 0)&&(EC11_KEY_DoubleClick_Count <= KEY_COUNT_DUALCLICKTIME))   
             -//ËÉ¿ª°´¼üºó£¬ÓÖÔÚ¶¨Ê±Æ÷ÔÚË«»÷Ê±¼äÄÚ°´ÏÂ°´¼ü
 317   1      //        {                                                                                               
             -//ÖÃÎ»Ë«»÷°´¼ü±êÖ¾
 318   1      //            FLAG_EC11_KEY_DoubleClick = 1;
 319   1      //        }
 320   1      
 321   1      //        if(EC11_KEY_COUNT == KEY_COUNT_LONGTIME)    //°´ÏÂ°´¼üÊ±¼äµ½´ï³¤°´Ê±¼ä
 322   1      //        {                                           //ÖÃÎ»³¤°´°´¼ü±êÖ¾²¢¸´Î»¶Ì°´°´¼ü±êÖ¾
 323   1      //            FLAG_EC11_KEY_LongClick = 1;
 324   1      //            FLAG_EC11_KEY_ShotClick = 0;
 325   1      //        }
 326   1      
 327   1      //    }
 328   1      //    else    //====¼ì²âµ½°´¼üËÉ¿ª====//     
 329   1      //    {
 330   1      //        if(EC11_KEY_COUNT < KEY_COUNT_DESHAKING)    //Ã»µ½Ïû¶¶Ê±³¤¾ÍËÉ¿ª°´¼ü£¬¸´Î»ËùÓÐ¶¨Ê±Æ÷ºÍ°´¼ü±êÖ¾
 331   1      //        {
 332   1      //            EC11_KEY_COUNT = 0;
 333   1      //            FLAG_EC11_KEY_ShotClick = 0;
 334   1      //            FLAG_EC11_KEY_LongClick = 0;
 335   1      //            FLAG_EC11_KEY_DoubleClick = 0;
 336   1      //            EC11_KEY_DoubleClick_Count = 0;
 337   1      //        }
 338   1      //        else
 339   1      //        {
 340   1      //            
 341   1      //            if(FLAG_EC11_KEY_ShotClick == 1)        //¶Ì°´°´¼ü¶¨Ê±ÓÐÐ§ÆÚ¼ä
 342   1      //            {
 343   1      //                if((FLAG_EC11_KEY_DoubleClick == 0)&&(EC11_KEY_DoubleClick_Count >= 0)) 
 344   1      //                    EC11_KEY_DoubleClick_Count++;
 345   1      //                if((FLAG_EC11_KEY_DoubleClick == 1)&&(EC11_KEY_DoubleClick_Count <= KEY_COUNT_DUALCLICKT
             -IME))   //Èç¹ûÔÚ¹æ¶¨Ë«»÷Ê±¼äÄÚÔÙ´Î°´ÏÂ°´¼ü
 346   1      //                {                                                                                       
             -        //ÈÏÎª°´¼üÊÇË«»÷¶¯×÷
 347   1      //                    FLAG_EC11_KEY_DoubleClick = 2;
 348   1      //                }   
 349   1      
 350   1      //                if((FLAG_EC11_KEY_DoubleClick == 0)&&(EC11_KEY_DoubleClick_Count > KEY_COUNT_DUALCLICKTI
             -ME))    //Èç¹ûÃ»ÓÐÔÚ¹æ¶¨Ë«»÷Ê±¼äÄÚÔÙ´Î°´ÏÂ°´¼ü
 351   1      //                    FLAG_EC11_KEY_ShotClick = 0;                                                        
             -        //ÈÏÎª°´¼üÊÇµ¥»÷¶¯×÷
 352   1      //            }
C51 COMPILER V9.56.0.0   EC06_KEY                                                          09/07/2020 22:21:34 PAGE 7   

 353   1      
 354   1      //            if(FLAG_EC11_KEY_LongClick == 1)        //¼ì²âµ½³¤°´°´¼üËÉ¿ª
 355   1      //                FLAG_EC11_KEY_LongClick = 0;
 356   1      //        }
 357   1      
 358   1      //    }
 359   1              
 360   1          //>>>>>>>>>>>>>>>±àÂëÆ÷°´¼ü°´ÏÂ²¢Õý×ª´¦Àí³ÌÐò<<<<<<<<<<<<<<<//
 361   1          if(EC11_Value == 3)
 362   1          {
 363   2              //--------±àÂëÆ÷°´¼ü°´ÏÂ²¢Õý×ª¶¯×÷´úÂë--------//
 364   2                
 365   2          }
 366   1      
 367   1          //>>>>>>>>>>>>>>>>±àÂëÆ÷°´¼ü°´ÏÂ²¢·´×ª´¦Àí³ÌÐò<<<<<<<<<<<<<<<<//
 368   1          if(EC11_Value == -3)
 369   1          {
 370   2              //--------±àÂëÆ÷°´¼ü°´ÏÂ²¢·´×ª¶¯×÷´úÂë--------//
 371   2        
 372   2          }
 373   1      
 374   1         
 375   1      
 376   1      
 377   1          //>>>>>>>>>>>>>>>>±àÂëÆ÷°´¼ü·ÖÎö´¦Àí³ÌÐò<<<<<<<<<<<<<<<<//
 378   1          if(EC11_KEY_COUNT > KEY_COUNT_DESHAKING)    //¶Ì°´°´¼üÑÓÊ±µ½ÁËÊ±¼ä
 379   1          {
 380   2      
 381   2              //¶Ì°´°´¼ü¶¯×÷½áÊø´úÂë
 382   2              if((FLAG_EC11_KEY_ShotClick == 0)&&(EC11_KEY_DoubleClick_Count > KEY_COUNT_DUALCLICKTIME)&&(EC11_K
             -EY_COUNT < KEY_COUNT_LONGTIME))   //¶Ì°´°´¼ü¶¯×÷½áÊø´úÂë
 383   2              {
 384   3                  //--------¶Ì°´°´¼ü¶¯×÷½áÊø´úÂë--------//
 385   3      //            EC11_NUM_SW++;
 386   3      //            if(EC11_NUM_SW >= 4)
 387   3      //                EC11_NUM_SW = 1;
 388   3                  AnalyzeResult = 1;
 389   3                  //--------Çå³ý±êÖ¾Î»--------//
 390   3                  EC11_KEY_COUNT = 0;
 391   3                  EC11_KEY_DoubleClick_Count = 0;
 392   3                  FLAG_EC11_KEY_DoubleClick = 0;
 393   3              }
 394   2      
 395   2              //Ë«»÷°´¼ü¶¯×÷½áÊø´úÂë
 396   2              if((FLAG_EC11_KEY_DoubleClick == 2)&&(EC11_KEY_DoubleClick_Count > 0)&&(EC11_KEY_DoubleClick_Count
             - <= KEY_COUNT_DUALCLICKTIME)) //Ë«»÷°´¼ü¶¯×÷½áÊø´úÂë
 397   2              {
 398   3                  //--------Ë«»÷°´¼ü¶¯×÷½áÊø´úÂë--------//
 399   3      //            if(EC11_NUM_SW == 5)
 400   3      //                EC11_NUM_SW = 0;
 401   3      //            if(EC11_NUM_SW == 4)
 402   3      //                EC11_NUM_SW = 5;
 403   3      
 404   3      //            if(EC11_NUM_SW <4)
 405   3      //            {
 406   3      //                EC11_NUM_SW = 4;
 407   3      //            }
 408   3                  AnalyzeResult = 2;
 409   3                  //--------Çå³ý±êÖ¾Î»--------//
 410   3                  EC11_KEY_COUNT = 0;
 411   3                  EC11_KEY_DoubleClick_Count = 0;
 412   3                  FLAG_EC11_KEY_ShotClick = 0;
C51 COMPILER V9.56.0.0   EC06_KEY                                                          09/07/2020 22:21:34 PAGE 8   

 413   3                  FLAG_EC11_KEY_DoubleClick = 0;
 414   3                  
 415   3              }
 416   2      
 417   2              //Á¬Ðø³¤°´°´¼ü°´ÏÂ´úÂë
 418   2              if((FLAG_EC11_KEY_LongClick == 1)&&(EC11_KEY_COUNT >= KEY_COUNT_LONGTIME))  //Á¬Ðø³¤°´°´¼ü°´ÏÂ´úÂë
 419   2              {
 420   3                  TMP_Value ++;
 421   3                  if(TMP_Value % KEY_LONG_REPEAT_TIME == 0)
 422   3                  {
 423   4                      TMP_Value = 0;
 424   4                      //-------Á¬Ðø³¤°´°´¼ü°´ÏÂ´úÂë--------//
 425   4                      AnalyzeResult = 4;
 426   4                  }
 427   3              }
 428   2      
 429   2              //³¤°´°´¼ü¶¯×÷½áÊø´úÂë
 430   2              if((FLAG_EC11_KEY_LongClick == 0)&&(EC11_KEY_COUNT >= KEY_COUNT_LONGTIME))  //³¤°´°´¼ü¶¯×÷½áÊø´úÂë
 431   2              {                                                                           
 432   3                  //--------³¤°´°´¼ü°´ÏÂ¶¯×÷½áÊø´úÂë--------//
 433   3      //            EC11_NUM_SW = 0;
 434   3      //            G_PWM_NUM1 = 0x20;
 435   3      //            G_PWM_NUM2 = 0x20;
 436   3      //            G_PWM_NUM3 = 0x20;
 437   3                  AnalyzeResult = 3;
 438   3                  //--------Çå³ý±êÖ¾Î»--------//
 439   3                  EC11_KEY_COUNT = 0;
 440   3              }
 441   2      
 442   2      
 443   2          }
 444   1          return AnalyzeResult;
 445   1      }
 446          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    387    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     20    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =     11    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
